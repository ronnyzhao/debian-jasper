From: Markus Koschany <apo@debian.org>
Date: Tue, 13 Nov 2018 14:06:09 +0100
Subject: CVE-2015-5221

Bug-Debian: https://bugs.debian.org/796253
Origin: https://github.com/mdadams/jasper/commit/df5d2867e8004e51e18b89865bc4aa69229227b3
---
 src/libjasper/mif/mif_cod.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/libjasper/mif/mif_cod.c b/src/libjasper/mif/mif_cod.c
index a1b29dc..e0f1d3a 100644
--- a/src/libjasper/mif/mif_cod.c
+++ b/src/libjasper/mif/mif_cod.c
@@ -569,13 +569,13 @@ static int mif_process_cmpt(mif_hdr_t *hdr, char *buf)
 			break;
 		}
 	}
-	jas_tvparser_destroy(tvp);
 	if (!cmpt->sampperx || !cmpt->samppery) {
 		goto error;
 	}
 	if (mif_hdr_addcmpt(hdr, hdr->numcmpts, cmpt)) {
 		goto error;
 	}
+	jas_tvparser_destroy(tvp);
 	return 0;
 
 error:
