From: Markus Koschany <apo@debian.org>
Date: Sat, 13 Apr 2019 12:55:02 +0200
Subject: CVE-2018-19542

Origin: https://github.com/mdadams/jasper/pull/200/commits/fc62d1b7164ded2405fd6a0604548b34a5a77462
---
 src/libjasper/jp2/jp2_dec.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/libjasper/jp2/jp2_dec.c b/src/libjasper/jp2/jp2_dec.c
index 70a7cba..7778fdc 100644
--- a/src/libjasper/jp2/jp2_dec.c
+++ b/src/libjasper/jp2/jp2_dec.c
@@ -376,6 +376,9 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)
 				jas_image_setcmpttype(dec->image, newcmptno, jp2_getct(jas_image_clrspc(dec->image), 0, channo + 1));
 				}
 #endif
+			} else {
+				jas_eprintf("error: invalid MTYP in CMAP box\n");
+				goto error;
 			}
 		}
 	}
