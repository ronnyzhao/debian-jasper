From: Markus Koschany <apo@debian.org>
Date: Wed, 5 Dec 2018 21:23:53 +0100
Subject: CVE-2018-19539

There is no official patch yet. This is the fix for bug number 2.

Bug-Upstream: https://github.com/mdadams/jasper/issues/182
---
 src/libjasper/base/jas_image.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/libjasper/base/jas_image.c b/src/libjasper/base/jas_image.c
index f6a2145..d22f1c1 100644
--- a/src/libjasper/base/jas_image.c
+++ b/src/libjasper/base/jas_image.c
@@ -438,6 +438,9 @@ int jas_image_readcmpt(jas_image_t *image, int cmptno, jas_image_coord_t x,
 	jas_seqent_t *d;
 	int drs;
 
+	if(data == NULL)
+		return -1;
+
 	if (cmptno < 0 || cmptno >= image->numcmpts_) {
 		return -1;
 	}
