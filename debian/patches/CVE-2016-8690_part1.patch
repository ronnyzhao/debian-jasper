From: Markus Koschany <apo@debian.org>
Date: Fri, 16 Nov 2018 20:38:43 +0100
Subject: CVE-2016-8690_part1

The original commit also introduced a new debug option which was omitted here
because it is unrelated to the issue at hand. Later it was discovered that the
fix was incomplete and two other CVE were requested, CVE-2016-8884 and
CVE-2016-8885. See _part2 for more information.

Origin: https://github.com/mdadams/jasper/commit/8f62b4761711d036fd8964df256b938c809b7fca
---
 src/libjasper/bmp/bmp_dec.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/libjasper/bmp/bmp_dec.c b/src/libjasper/bmp/bmp_dec.c
index 7a6dcb1..7643a4c 100644
--- a/src/libjasper/bmp/bmp_dec.c
+++ b/src/libjasper/bmp/bmp_dec.c
@@ -440,7 +440,7 @@ static int bmp_getint32(jas_stream_t *in, int_fast32_t *val)
 		if ((c = jas_stream_getc(in)) == EOF) {
 			return -1;
 		}
-		v |= (c << 24);
+		v |= (JAS_CAST(uint_fast32_t, c) << 24);
 		if (--n <= 0) {
 			break;
 		}
